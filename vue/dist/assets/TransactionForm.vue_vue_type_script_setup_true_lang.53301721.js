import{K as k,L as S,M as C,N as g,r as x,d as v,k as V,a as u,z as d,B as y,C as _,D as B,Z as A,f as p,F as $,G as T,A as D,c as F,O as N,e as h,h as i,H as L,g as M}from"./index.bd0352d0.js";import{u as O,_ as w,r as b}from"./Button.vue_vue_type_script_setup_true_lang.f20af2f8.js";import{a as f}from"./SectionTitle.79345ca8.js";const m=k(),E=S("TransactionStore",{state:()=>({newTransaction:{form:{amount:null,client_id:null,transaction_date:null},loading:!1,isModalOpen:!1},pagination:{current_page:1,last_page:void 0,per_page:void 0},selectedClientId:null,transactions:[],clientList:[],loading:!1}),getters:{disableSubmit:t=>!t.newTransaction.form.amount||!t.newTransaction.form.client_id||!t.newTransaction.form.transaction_date},actions:{async _getPaginateTransactions(){try{this.$state.loading=!0;let t="";this.$state.selectedClientId?t=`/client/${this.$state.selectedClientId}/transactions`:t="/transaction",t+=`?page=${this.$state.pagination.current_page}`;const e=await f.get(t),{data:a}=e,{current_page:n,last_page:s,per_page:l}=a.meta;this.$state.pagination={current_page:n,last_page:s,per_page:l},this.$state.transactions=a.data}catch(t){console.log(t)}finally{this.$state.loading=!1}},async _getClientList(){try{this.$state.loading=!0;const t=await f.get("/clients"),{data:e}=t;this.$state.clientList=e.data}catch(t){console.log(t)}finally{this.$state.loading=!1}},async _addTransaction(){try{this.$state.newTransaction.loading=!0;const{amount:t,client_id:e,transaction_date:a}=this.$state.newTransaction.form,n=await f.post("/transaction",{amount:t,client_id:e,transaction_date:a});if(n.status===201&&(this._getPaginateTransactions(),this.$state.newTransaction.isModalOpen=!1,m.success("Transaction created successfully")),n.status===200){const s=C(n.data.errors);s&&m.error(s[0])}}catch(t){m.error(g(t))}finally{this.$state.newTransaction.loading=!1}},async _updateTransaction(t){try{this.$state.newTransaction.loading=!0;const{amount:e,client_id:a,transaction_date:n}=this.$state.newTransaction.form,s=await f.put(`/transaction/${t}`,{amount:e,client_id:a,transaction_date:n});x.back()}catch(e){m.error(g(e))}finally{this.$state.newTransaction.loading=!1}},async _deleteTransaction(t){try{(await f.delete(`/transaction/${t}`)).status===200&&(m.success("Client deleted successfully"),this._getPaginateTransactions())}catch(e){m.error(g(e))}},getTransaction(t){const e=this.$state.transactions.find(a=>a.id===t);return e&&(this.$state.newTransaction.form={amount:e.amount,client_id:e.client.id,transaction_date:e.transaction_date}),e},eraseForm(){this.$state.newTransaction.form={amount:null,client_id:null,transaction_date:null}}}}),q={key:0,class:"block text-sm font-medium"},I=["disabled"],P={key:0,value:null},U=["value"],j=v({__name:"SelectField",props:{options:{type:Array,required:!0},disable:{type:Boolean,default:!1},titleShow:{type:Boolean,default:!0},title:{type:String},input:{type:Object,default:null},dark:{type:Boolean,default:!1},errors:{type:Object},emptyValue:{type:Boolean,default:!0}},emits:["update"],setup(t,{emit:e}){const a=t,n=V();return a.input&&(n.value=a.input.value),(s,l)=>(u(),d($,null,[t.titleShow?(u(),d("label",q,y(t.title),1)):_("",!0),B(p("select",{id:"countries",disabled:t.disable,"onUpdate:modelValue":l[0]||(l[0]=r=>n.value=r),onChange:l[1]||(l[1]=r=>s.$emit("update",n.value)),class:D(["border border-gray-300 file:after:text-sm rounded-md focus:ring-gray-500 focus:border-gray-500 block w-full p-2.5",t.dark?"bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500":"bg-gray-50  text-gray-900"])},[t.emptyValue?(u(),d("option",P,"--Empty--")):_("",!0),(u(!0),d($,null,T(t.options,(r,c)=>(u(),d("option",{value:r.id,key:c},y(r.name),9,U))),128))],42,I),[[A,n.value]]),(u(!0),d($,null,T(t.errors,r=>(u(),d("div",{key:r.$uid,class:"text-rose-700 text-base font-medium mt-1 px-2"},y(r.$message),1))),128))],64))}}),z=["onSubmit"],G={class:"mb-3"},J=v({__name:"TransactionForm",props:{clients:{type:Array,required:!0},selectDisable:{type:Boolean,default:!1}},emits:["submit"],setup(t,{emit:e}){const a=E(),n=F(()=>({amount:{required:b},client_id:{required:b},transaction_date:{required:b}})),s=O(n,a.newTransaction.form),l=()=>{s.value.$validate(),s.value.$error||e("submit")};return N(()=>{a.eraseForm()}),(r,c)=>(u(),d("form",{onSubmit:M(l,["prevent"])},[p("div",G,[h(j,{options:t.clients.map(o=>({id:o.id,name:o.firstName+" "+o.lastName})),title:"Client",emptyValue:!1,input:{value:i(a).newTransaction.form.client_id},errors:i(s).client_id.$errors,onUpdate:c[0]||(c[0]=o=>i(a).newTransaction.form.client_id=o),disable:t.selectDisable},null,8,["options","input","errors","disable"])]),p("div",null,[h(w,{title:"Amount",input:{value:i(a).newTransaction.form.amount},errors:i(s).amount.$errors,"title-color":"black",type:"number",step:"0.01",onChange:c[1]||(c[1]=o=>i(a).newTransaction.form.amount=o)},null,8,["input","errors","step"])]),p("div",null,[h(w,{title:"Transaction Date",input:{value:i(a).newTransaction.form.transaction_date},errors:i(s).transaction_date.$errors,"title-color":"black",type:"date",onChange:c[2]||(c[2]=o=>i(a).newTransaction.form.transaction_date=o)},null,8,["input","errors"])]),L(r.$slots,"default")],40,z))}});export{J as _,E as u};
